@inherits LayoutComponentBase
@inject IJSRuntime JSRuntime

<PageTitle>KEYSTORE</PageTitle>

<HeadContent>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
</HeadContent>

<div>
    <NavMenu />
</div>

<div class="main-content">
    @Body
</div>

<script>

    window.siteUtils = {

        initializeCarousel: function(carouselId, options = {}) {
            const defaultOptions = {
                interval: 5000,
                wrap: true,
                touch: true,
                pause: 'hover',
                ride: 'carousel'
            };

            const finalOptions = { ...defaultOptions, ...options };

            const carouselElement = document.getElementById(carouselId);
            if (!carouselElement) {
                console.log(`Carousel ${carouselId} no encontrado`);
                return null;
            }

            try {

                const existingCarousel = bootstrap.Carousel.getInstance(carouselElement);
                if (existingCarousel) {
                    existingCarousel.dispose();
                }

  
                const carousel = new bootstrap.Carousel(carouselElement, finalOptions);
                console.log(`Carousel ${carouselId} inicializado correctamente`);

                return carousel;
            } catch (error) {
                console.error(`Error inicializando carousel ${carouselId}:`, error);
                return null;
            }
        },

        carouselControl: function(carouselId, direction) {
            const carousel = document.getElementById(carouselId);
            if (carousel) {
                const bsCarousel = bootstrap.Carousel.getInstance(carousel);
                if (bsCarousel) {
                    if (direction === 'prev') {
                        bsCarousel.prev();
                    } else if (direction === 'next') {
                        bsCarousel.next();
                    }
                }
            }
        },


        carouselGoTo: function(carouselId, slideIndex) {
            const carousel = document.getElementById(carouselId);
            if (carousel) {
                const bsCarousel = bootstrap.Carousel.getInstance(carousel);
                if (bsCarousel) {
                    bsCarousel.to(slideIndex);
                }
            }
        }
    };

    window.initializeHeroCarousel = function() {
        console.log('Llamando a initializeHeroCarousel...');
        return window.siteUtils.initializeCarousel('heroCarousel', {
            interval: 5000,
            wrap: true,
            touch: true,
            pause: 'hover'
        });
    };

    window.initDropdowns = function() {

        if (typeof bootstrap === 'undefined') {
            console.error('Bootstrap no está cargado');
            return;
        }

        console.log('Inicializando dropdowns...');


        const dropdownElements = document.querySelectorAll('[data-bs-toggle="dropdown"]');

        dropdownElements.forEach((element, index) => {
            try {

                let dropdownInstance = bootstrap.Dropdown.getInstance(element);

                if (!dropdownInstance) {

                    dropdownInstance = new bootstrap.Dropdown(element);
                    console.log(`Dropdown ${index + 1} inicializado manualmente`);
                } else {
                    console.log(`Dropdown ${index + 1} ya estaba inicializado`);
                }
            } catch (error) {
                console.error(`Error inicializando dropdown ${index + 1}:`, error);
            }
        });

        console.log(`Total dropdowns procesados: ${dropdownElements.length}`);
    };

    document.addEventListener('DOMContentLoaded', function() {
        console.log('DOM cargado');
        console.log('Bootstrap disponible:', typeof bootstrap !== 'undefined');


        setTimeout(() => {
            if (typeof bootstrap !== 'undefined') {
                console.log('Bootstrap confirmado, inicializando dropdowns automáticamente...');
            }
        }, 500);
    });
</script>